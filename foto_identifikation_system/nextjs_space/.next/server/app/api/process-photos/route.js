"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/process-photos/route";
exports.ids = ["app/api/process-photos/route"];
exports.modules = {

/***/ "@aws-sdk/client-s3":
/*!*************************************!*\
  !*** external "@aws-sdk/client-s3" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@aws-sdk/client-s3");

/***/ }),

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-photos%2Froute&page=%2Fapi%2Fprocess-photos%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-photos%2Froute.ts&appDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-photos%2Froute&page=%2Fapi%2Fprocess-photos%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-photos%2Froute.ts&appDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_dyai_Dokumente_DYAI_home_Web_Simavi_Simavi_semantic_image_vision_foto_identifikation_system_nextjs_space_app_api_process_photos_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/process-photos/route.ts */ \"(rsc)/./app/api/process-photos/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/process-photos/route\",\n        pathname: \"/api/process-photos\",\n        filename: \"route\",\n        bundlePath: \"app/api/process-photos/route\"\n    },\n    resolvedPagePath: \"/home/dyai/Dokumente/DYAI_home/Web/Simavi/Simavi-semantic_image_vision/foto_identifikation_system/nextjs_space/app/api/process-photos/route.ts\",\n    nextConfigOutput,\n    userland: _home_dyai_Dokumente_DYAI_home_Web_Simavi_Simavi_semantic_image_vision_foto_identifikation_system_nextjs_space_app_api_process_photos_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/process-photos/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm9jZXNzLXBob3RvcyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGcHJvY2Vzcy1waG90b3MlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZwcm9jZXNzLXBob3RvcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGZHlhaSUyRkRva3VtZW50ZSUyRkRZQUlfaG9tZSUyRldlYiUyRlNpbWF2aSUyRlNpbWF2aS1zZW1hbnRpY19pbWFnZV92aXNpb24lMkZmb3RvX2lkZW50aWZpa2F0aW9uX3N5c3RlbSUyRm5leHRqc19zcGFjZSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGaG9tZSUyRmR5YWklMkZEb2t1bWVudGUlMkZEWUFJX2hvbWUlMkZXZWIlMkZTaW1hdmklMkZTaW1hdmktc2VtYW50aWNfaW1hZ2VfdmlzaW9uJTJGZm90b19pZGVudGlmaWthdGlvbl9zeXN0ZW0lMkZuZXh0anNfc3BhY2UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzhGO0FBQzNLO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBwLz9hOGFmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9ob21lL2R5YWkvRG9rdW1lbnRlL0RZQUlfaG9tZS9XZWIvU2ltYXZpL1NpbWF2aS1zZW1hbnRpY19pbWFnZV92aXNpb24vZm90b19pZGVudGlmaWthdGlvbl9zeXN0ZW0vbmV4dGpzX3NwYWNlL2FwcC9hcGkvcHJvY2Vzcy1waG90b3Mvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Byb2Nlc3MtcGhvdG9zL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHJvY2Vzcy1waG90b3NcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3Byb2Nlc3MtcGhvdG9zL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvZHlhaS9Eb2t1bWVudGUvRFlBSV9ob21lL1dlYi9TaW1hdmkvU2ltYXZpLXNlbWFudGljX2ltYWdlX3Zpc2lvbi9mb3RvX2lkZW50aWZpa2F0aW9uX3N5c3RlbS9uZXh0anNfc3BhY2UvYXBwL2FwaS9wcm9jZXNzLXBob3Rvcy9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcHJvY2Vzcy1waG90b3Mvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-photos%2Froute&page=%2Fapi%2Fprocess-photos%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-photos%2Froute.ts&appDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/process-photos/route.ts":
/*!*****************************************!*\
  !*** ./app/api/process-photos/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_s3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/s3 */ \"(rsc)/./lib/s3.ts\");\n/* harmony import */ var _lib_exif_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/exif-utils */ \"(rsc)/./lib/exif-utils.ts\");\nconst dynamic = \"force-dynamic\";\n\n\n\n\nconst prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_1__.PrismaClient();\nasync function POST(request) {\n    try {\n        const formData = await request.formData();\n        const batchId = formData.get(\"batchId\");\n        if (!batchId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Batch-ID fehlt\"\n            }, {\n                status: 400\n            });\n        }\n        // Alle Dateien aus FormData extrahieren\n        const files = [];\n        for (const [key, value] of formData.entries()){\n            if (key.startsWith(\"file_\") && value instanceof File) {\n                const index = parseInt(key.replace(\"file_\", \"\"));\n                files.push({\n                    file: value,\n                    index\n                });\n            }\n        }\n        if (files.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Keine Dateien gefunden\"\n            }, {\n                status: 400\n            });\n        }\n        // Upload-Batch in Datenbank erstellen\n        await prisma.uploadBatch.create({\n            data: {\n                batchId,\n                totalFiles: files.length,\n                status: \"processing\"\n            }\n        });\n        // Streaming Response erstellen\n        const stream = new ReadableStream({\n            async start (controller) {\n                const encoder = new TextEncoder();\n                const sendData = (data)=>{\n                    controller.enqueue(encoder.encode(`data: ${JSON.stringify(data)}\\n\\n`));\n                };\n                let processedCount = 0;\n                let completedCount = 0;\n                let failedCount = 0;\n                for (const { file, index } of files){\n                    try {\n                        processedCount++;\n                        sendData({\n                            type: \"progress\",\n                            processed: processedCount,\n                            completed: completedCount,\n                            failed: failedCount,\n                            current: file.name\n                        });\n                        // EXIF-Daten extrahieren\n                        const exifData = await (0,_lib_exif_utils__WEBPACK_IMPORTED_MODULE_3__.extractExifData)(file);\n                        const geoData = (0,_lib_exif_utils__WEBPACK_IMPORTED_MODULE_3__.extractGeoData)(exifData);\n                        const cameraModel = (0,_lib_exif_utils__WEBPACK_IMPORTED_MODULE_3__.getCameraModel)(exifData);\n                        const dateTimeTaken = (0,_lib_exif_utils__WEBPACK_IMPORTED_MODULE_3__.getDateTimeTaken)(exifData);\n                        // File zu Buffer konvertieren\n                        const buffer = Buffer.from(await file.arrayBuffer());\n                        // File zu S3 hochladen\n                        const cloudStoragePath = await (0,_lib_s3__WEBPACK_IMPORTED_MODULE_2__.uploadFile)(buffer, file.name);\n                        // Offizielle Ortsnamen via Reverse Geocoding abrufen (falls GPS verfügbar)\n                        let placeName = null;\n                        if (geoData.latitude && geoData.longitude) {\n                            placeName = await getPlaceName(geoData.latitude, geoData.longitude);\n                        }\n                        // Vision AI für Bildanalyse\n                        const base64String = buffer.toString(\"base64\");\n                        const analysisResult = await analyzeImage(base64String, file.name, placeName);\n                        if (!analysisResult || !analysisResult.location || !analysisResult.scene) {\n                            throw new Error(\"KI-Analyse fehlgeschlagen - unvollst\\xe4ndige Ergebnisse\");\n                        }\n                        // Sequenz-Nummer für Kategorie ermitteln\n                        const sequenceNumber = await getNextSequenceNumber(analysisResult.location);\n                        // Neuen Namen generieren\n                        const fileExtension = file.name.split(\".\").pop()?.toLowerCase() || \"jpg\";\n                        const newName = `${analysisResult.location}_${analysisResult.scene}_${sequenceNumber.toString().padStart(3, \"0\")}.${fileExtension}`;\n                        // In Datenbank speichern\n                        const photo = await prisma.photo.create({\n                            data: {\n                                originalName: file.name,\n                                newName,\n                                cloudStoragePath,\n                                location: analysisResult.location,\n                                scene: analysisResult.scene,\n                                sequenceNumber,\n                                latitude: geoData.latitude,\n                                longitude: geoData.longitude,\n                                altitude: geoData.altitude,\n                                exifData: exifData || {},\n                                dateTimeTaken,\n                                cameraModel,\n                                uploadBatch: batchId,\n                                processed: true\n                            }\n                        });\n                        completedCount++;\n                        sendData({\n                            type: \"photo\",\n                            data: photo\n                        });\n                    } catch (error) {\n                        console.error(`Fehler bei Verarbeitung von ${file.name}:`, error);\n                        failedCount++;\n                        // Fehler in Datenbank speichern\n                        try {\n                            await prisma.photo.create({\n                                data: {\n                                    originalName: file.name,\n                                    newName: file.name,\n                                    cloudStoragePath: \"\",\n                                    location: \"Unbekannt\",\n                                    scene: \"Fehler\",\n                                    sequenceNumber: 0,\n                                    uploadBatch: batchId,\n                                    processed: false,\n                                    processingError: error.message\n                                }\n                            });\n                        } catch (dbError) {\n                            console.error(\"Fehler beim Speichern in Datenbank:\", dbError);\n                        }\n                        sendData({\n                            type: \"error\",\n                            message: `Fehler bei ${file.name}: ${error.message}`\n                        });\n                    }\n                    // Fortschritt aktualisieren\n                    sendData({\n                        type: \"progress\",\n                        processed: processedCount,\n                        completed: completedCount,\n                        failed: failedCount\n                    });\n                }\n                // Upload-Batch Status aktualisieren\n                await prisma.uploadBatch.update({\n                    where: {\n                        batchId\n                    },\n                    data: {\n                        processedFiles: processedCount,\n                        completedFiles: completedCount,\n                        failedFiles: failedCount,\n                        status: failedCount === files.length ? \"failed\" : \"completed\"\n                    }\n                });\n                sendData({\n                    type: \"completed\"\n                });\n                controller.enqueue(encoder.encode(\"data: [DONE]\\n\\n\"));\n                controller.close();\n            }\n        });\n        return new Response(stream, {\n            headers: {\n                \"Content-Type\": \"text/event-stream\",\n                \"Cache-Control\": \"no-cache\",\n                \"Connection\": \"keep-alive\"\n            }\n        });\n    } catch (error) {\n        console.error(\"Unerwarteter Fehler:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Unerwarteter Server-Fehler\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function analyzeImage(base64String, fileName, placeName) {\n    try {\n        const placeContext = placeName ? `\\n\\nZusätzliche Kontext-Information: Das Foto wurde aufgenommen bei/in \"${placeName}\". Wenn dies ein spezifischer Ort ist (z.B. eine Parkanlage, ein Restaurant, ein Denkmal), verwende diesen Namen als Ort-Kategorie. Ansonsten verwende eine allgemeine Kategorie.` : \"\";\n        const response = await fetch(\"https://apps.abacus.ai/v1/chat/completions\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${process.env.ABACUSAI_API_KEY}`\n            },\n            body: JSON.stringify({\n                model: \"gpt-4.1-mini\",\n                messages: [\n                    {\n                        role: \"user\",\n                        content: [\n                            {\n                                type: \"text\",\n                                text: `Analysiere dieses Bild und bestimme:\n1. Die Ort-Kategorie (z.B. Strand, Restaurant, Auto, Wald, Park, Büro, Zuhause, etc.) - maximal 2-3 Wörter auf Deutsch\n2. Eine Szene-Beschreibung mit einem Adjektiv/Wort auf Deutsch (z.B. sonnig, gemütlich, modern, dunkel, etc.)${placeContext}\n\n**WICHTIG FÜR SCHILDER:**\nFalls im Bild ein Schild, Plakat, Hinweisschild, Straßenschild, Wegweiser, Informationstafel oder ähnliches zu sehen ist:\n- Verwende \"Schild\" als Ort-Kategorie\n- Lies den Text auf dem Schild und verwende ihn als Szene-Beschreibung (z.B. \"Parken-verboten\", \"Eingang-A\", \"Berlin-Hauptbahnhof\", etc.)\n- Falls mehrere Texte auf dem Schild sind, verwende den wichtigsten/größten Text\n- Entferne Satzzeichen und verwende Bindestriche statt Leerzeichen\n\nAntworte nur in folgendem JSON-Format:\n{\n  \"location\": \"Ort-Kategorie\",\n  \"scene\": \"Szene-Beschreibung\"\n}\n\nVerwende nur deutsche Begriffe und halte sie kurz und prägnant. Für die Ort-Kategorie: Verwende Bindestriche statt Leerzeichen (z.B. \"Central-Park\" statt \"Central Park\").`\n                            },\n                            {\n                                type: \"image_url\",\n                                image_url: {\n                                    url: `data:image/jpeg;base64,${base64String}`\n                                }\n                            }\n                        ]\n                    }\n                ],\n                response_format: {\n                    type: \"json_object\"\n                },\n                max_tokens: 200,\n                temperature: 0.3\n            })\n        });\n        if (!response.ok) {\n            throw new Error(`Vision AI API Fehler: ${response.status}`);\n        }\n        const result = await response.json();\n        const content = result.choices?.[0]?.message?.content;\n        if (!content) {\n            throw new Error(\"Keine Antwort von Vision AI erhalten\");\n        }\n        const parsed = JSON.parse(content);\n        if (!parsed.location || !parsed.scene) {\n            throw new Error(\"Unvollst\\xe4ndige Vision AI Analyse\");\n        }\n        // Leerzeichen durch Bindestriche ersetzen und Sonderzeichen entfernen\n        const sanitizeForFilename = (str)=>{\n            return str.trim().replace(/\\s+/g, \"-\").replace(/[^a-zA-Z0-9äöüÄÖÜß\\-]/g, \"\").replace(/-+/g, \"-\");\n        };\n        return {\n            location: sanitizeForFilename(parsed.location),\n            scene: sanitizeForFilename(parsed.scene)\n        };\n    } catch (error) {\n        console.error(\"Vision AI Analyse Fehler:\", error);\n        throw new Error(`Vision AI Analyse fehlgeschlagen: ${error.message}`);\n    }\n}\nasync function getPlaceName(latitude, longitude) {\n    try {\n        // OpenStreetMap Nominatim API für Reverse Geocoding (kostenlos)\n        const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`, {\n            headers: {\n                \"User-Agent\": \"FotoIdentifikationSystem/1.0\"\n            }\n        });\n        if (!response.ok) {\n            console.warn(\"Nominatim API Fehler:\", response.status);\n            return null;\n        }\n        const data = await response.json();\n        // Priorisiere spezifische Orte\n        const placeName = data.address?.tourism || // z.B. Sehenswürdigkeiten, Denkmäler\n        data.address?.leisure || // z.B. Parks, Spielplätze\n        data.address?.amenity || // z.B. Restaurants, Cafés\n        data.address?.building || // z.B. spezifische Gebäude\n        data.address?.neighbourhood || // z.B. Stadtviertel\n        data.address?.suburb || // z.B. Stadtteile\n        data.address?.town || // z.B. kleine Städte\n        data.address?.city || // z.B. Städte\n        data.address?.village; // z.B. Dörfer\n        return placeName || null;\n    } catch (error) {\n        console.error(\"Fehler beim Abrufen des Ortsnamens:\", error);\n        return null;\n    }\n}\nasync function getNextSequenceNumber(location) {\n    try {\n        const counter = await prisma.categoryCounter.upsert({\n            where: {\n                categoryName: location\n            },\n            update: {\n                currentCounter: {\n                    increment: 1\n                }\n            },\n            create: {\n                categoryName: location,\n                currentCounter: 1\n            }\n        });\n        return counter.currentCounter;\n    } catch (error) {\n        console.error(\"Fehler beim Generieren der Sequenznummer:\", error);\n        return Math.floor(Math.random() * 1000) + 1; // Fallback\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Li9hcHAvYXBpL3Byb2Nlc3MtcGhvdG9zL3JvdXRlLnRzP2ViNWQiXSwic291cmNlc0NvbnRlbnQiOlsiXG5leHBvcnQgY29uc3QgZHluYW1pYyA9IFwiZm9yY2UtZHluYW1pY1wiO1xuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHsgdXBsb2FkRmlsZSB9IGZyb20gJ0AvbGliL3MzJztcbmltcG9ydCB7IGV4dHJhY3RFeGlmRGF0YSwgZXh0cmFjdEdlb0RhdGEsIGdldENhbWVyYU1vZGVsLCBnZXREYXRlVGltZVRha2VuIH0gZnJvbSAnQC9saWIvZXhpZi11dGlscyc7XG5cbmNvbnN0IHByaXNtYSA9IG5ldyBQcmlzbWFDbGllbnQoKTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmb3JtRGF0YSA9IGF3YWl0IHJlcXVlc3QuZm9ybURhdGEoKTtcbiAgICBjb25zdCBiYXRjaElkID0gZm9ybURhdGEuZ2V0KCdiYXRjaElkJykgYXMgc3RyaW5nO1xuXG4gICAgaWYgKCFiYXRjaElkKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0JhdGNoLUlEIGZlaGx0JyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIC8vIEFsbGUgRGF0ZWllbiBhdXMgRm9ybURhdGEgZXh0cmFoaWVyZW5cbiAgICBjb25zdCBmaWxlczogeyBmaWxlOiBGaWxlOyBpbmRleDogbnVtYmVyIH1bXSA9IFtdO1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIGZvcm1EYXRhLmVudHJpZXMoKSkge1xuICAgICAgaWYgKGtleS5zdGFydHNXaXRoKCdmaWxlXycpICYmIHZhbHVlIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGtleS5yZXBsYWNlKCdmaWxlXycsICcnKSk7XG4gICAgICAgIGZpbGVzLnB1c2goeyBmaWxlOiB2YWx1ZSwgaW5kZXggfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdLZWluZSBEYXRlaWVuIGdlZnVuZGVuJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIC8vIFVwbG9hZC1CYXRjaCBpbiBEYXRlbmJhbmsgZXJzdGVsbGVuXG4gICAgYXdhaXQgcHJpc21hLnVwbG9hZEJhdGNoLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGJhdGNoSWQsXG4gICAgICAgIHRvdGFsRmlsZXM6IGZpbGVzLmxlbmd0aCxcbiAgICAgICAgc3RhdHVzOiAncHJvY2Vzc2luZydcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFN0cmVhbWluZyBSZXNwb25zZSBlcnN0ZWxsZW5cbiAgICBjb25zdCBzdHJlYW0gPSBuZXcgUmVhZGFibGVTdHJlYW0oe1xuICAgICAgYXN5bmMgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzZW5kRGF0YSA9IChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2Rlci5lbmNvZGUoYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSl9XFxuXFxuYCkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGxldCBwcm9jZXNzZWRDb3VudCA9IDA7XG4gICAgICAgIGxldCBjb21wbGV0ZWRDb3VudCA9IDA7XG4gICAgICAgIGxldCBmYWlsZWRDb3VudCA9IDA7XG5cbiAgICAgICAgZm9yIChjb25zdCB7IGZpbGUsIGluZGV4IH0gb2YgZmlsZXMpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcHJvY2Vzc2VkQ291bnQrKztcbiAgICAgICAgICAgIHNlbmREYXRhKHsgXG4gICAgICAgICAgICAgIHR5cGU6ICdwcm9ncmVzcycsIFxuICAgICAgICAgICAgICBwcm9jZXNzZWQ6IHByb2Nlc3NlZENvdW50LCBcbiAgICAgICAgICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWRDb3VudCxcbiAgICAgICAgICAgICAgZmFpbGVkOiBmYWlsZWRDb3VudCxcbiAgICAgICAgICAgICAgY3VycmVudDogZmlsZS5uYW1lIFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEVYSUYtRGF0ZW4gZXh0cmFoaWVyZW5cbiAgICAgICAgICAgIGNvbnN0IGV4aWZEYXRhID0gYXdhaXQgZXh0cmFjdEV4aWZEYXRhKGZpbGUpO1xuICAgICAgICAgICAgY29uc3QgZ2VvRGF0YSA9IGV4dHJhY3RHZW9EYXRhKGV4aWZEYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IGNhbWVyYU1vZGVsID0gZ2V0Q2FtZXJhTW9kZWwoZXhpZkRhdGEpO1xuICAgICAgICAgICAgY29uc3QgZGF0ZVRpbWVUYWtlbiA9IGdldERhdGVUaW1lVGFrZW4oZXhpZkRhdGEpO1xuXG4gICAgICAgICAgICAvLyBGaWxlIHp1IEJ1ZmZlciBrb252ZXJ0aWVyZW5cbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEZpbGUgenUgUzMgaG9jaGxhZGVuXG4gICAgICAgICAgICBjb25zdCBjbG91ZFN0b3JhZ2VQYXRoID0gYXdhaXQgdXBsb2FkRmlsZShidWZmZXIsIGZpbGUubmFtZSk7XG5cbiAgICAgICAgICAgIC8vIE9mZml6aWVsbGUgT3J0c25hbWVuIHZpYSBSZXZlcnNlIEdlb2NvZGluZyBhYnJ1ZmVuIChmYWxscyBHUFMgdmVyZsO8Z2JhcilcbiAgICAgICAgICAgIGxldCBwbGFjZU5hbWU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGdlb0RhdGEubGF0aXR1ZGUgJiYgZ2VvRGF0YS5sb25naXR1ZGUpIHtcbiAgICAgICAgICAgICAgcGxhY2VOYW1lID0gYXdhaXQgZ2V0UGxhY2VOYW1lKGdlb0RhdGEubGF0aXR1ZGUsIGdlb0RhdGEubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVmlzaW9uIEFJIGbDvHIgQmlsZGFuYWx5c2VcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NFN0cmluZyA9IGJ1ZmZlci50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgICAgICAgICBjb25zdCBhbmFseXNpc1Jlc3VsdCA9IGF3YWl0IGFuYWx5emVJbWFnZShiYXNlNjRTdHJpbmcsIGZpbGUubmFtZSwgcGxhY2VOYW1lKTtcblxuICAgICAgICAgICAgaWYgKCFhbmFseXNpc1Jlc3VsdCB8fCAhYW5hbHlzaXNSZXN1bHQubG9jYXRpb24gfHwgIWFuYWx5c2lzUmVzdWx0LnNjZW5lKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignS0ktQW5hbHlzZSBmZWhsZ2VzY2hsYWdlbiAtIHVudm9sbHN0w6RuZGlnZSBFcmdlYm5pc3NlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNlcXVlbnotTnVtbWVyIGbDvHIgS2F0ZWdvcmllIGVybWl0dGVsblxuICAgICAgICAgICAgY29uc3Qgc2VxdWVuY2VOdW1iZXIgPSBhd2FpdCBnZXROZXh0U2VxdWVuY2VOdW1iZXIoYW5hbHlzaXNSZXN1bHQubG9jYXRpb24pO1xuXG4gICAgICAgICAgICAvLyBOZXVlbiBOYW1lbiBnZW5lcmllcmVuXG4gICAgICAgICAgICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCk/LnRvTG93ZXJDYXNlKCkgfHwgJ2pwZyc7XG4gICAgICAgICAgICBjb25zdCBuZXdOYW1lID0gYCR7YW5hbHlzaXNSZXN1bHQubG9jYXRpb259XyR7YW5hbHlzaXNSZXN1bHQuc2NlbmV9XyR7c2VxdWVuY2VOdW1iZXIudG9TdHJpbmcoKS5wYWRTdGFydCgzLCAnMCcpfS4ke2ZpbGVFeHRlbnNpb259YDtcblxuICAgICAgICAgICAgLy8gSW4gRGF0ZW5iYW5rIHNwZWljaGVyblxuICAgICAgICAgICAgY29uc3QgcGhvdG8gPSBhd2FpdCBwcmlzbWEucGhvdG8uY3JlYXRlKHtcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsTmFtZTogZmlsZS5uYW1lLFxuICAgICAgICAgICAgICAgIG5ld05hbWUsXG4gICAgICAgICAgICAgICAgY2xvdWRTdG9yYWdlUGF0aCxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbjogYW5hbHlzaXNSZXN1bHQubG9jYXRpb24sXG4gICAgICAgICAgICAgICAgc2NlbmU6IGFuYWx5c2lzUmVzdWx0LnNjZW5lLFxuICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyLFxuICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBnZW9EYXRhLmxhdGl0dWRlLFxuICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogZ2VvRGF0YS5sb25naXR1ZGUsXG4gICAgICAgICAgICAgICAgYWx0aXR1ZGU6IGdlb0RhdGEuYWx0aXR1ZGUsXG4gICAgICAgICAgICAgICAgZXhpZkRhdGE6IGV4aWZEYXRhIHx8IHt9LFxuICAgICAgICAgICAgICAgIGRhdGVUaW1lVGFrZW4sXG4gICAgICAgICAgICAgICAgY2FtZXJhTW9kZWwsXG4gICAgICAgICAgICAgICAgdXBsb2FkQmF0Y2g6IGJhdGNoSWQsXG4gICAgICAgICAgICAgICAgcHJvY2Vzc2VkOiB0cnVlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb21wbGV0ZWRDb3VudCsrO1xuICAgICAgICAgICAgc2VuZERhdGEoeyBcbiAgICAgICAgICAgICAgdHlwZTogJ3Bob3RvJywgXG4gICAgICAgICAgICAgIGRhdGE6IHBob3RvIFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBGZWhsZXIgYmVpIFZlcmFyYmVpdHVuZyB2b24gJHtmaWxlLm5hbWV9OmAsIGVycm9yKTtcbiAgICAgICAgICAgIGZhaWxlZENvdW50Kys7XG5cbiAgICAgICAgICAgIC8vIEZlaGxlciBpbiBEYXRlbmJhbmsgc3BlaWNoZXJuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBhd2FpdCBwcmlzbWEucGhvdG8uY3JlYXRlKHtcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICBvcmlnaW5hbE5hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICAgIG5ld05hbWU6IGZpbGUubmFtZSwgLy8gRmFsbGJhY2tcbiAgICAgICAgICAgICAgICAgIGNsb3VkU3RvcmFnZVBhdGg6ICcnLCAvLyBMZWVyIGJlaSBGZWhsZXJcbiAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiAnVW5iZWthbm50JyxcbiAgICAgICAgICAgICAgICAgIHNjZW5lOiAnRmVobGVyJyxcbiAgICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiAwLFxuICAgICAgICAgICAgICAgICAgdXBsb2FkQmF0Y2g6IGJhdGNoSWQsXG4gICAgICAgICAgICAgICAgICBwcm9jZXNzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgcHJvY2Vzc2luZ0Vycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGRiRXJyb3IpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmVobGVyIGJlaW0gU3BlaWNoZXJuIGluIERhdGVuYmFuazonLCBkYkVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2VuZERhdGEoeyBcbiAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJywgXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGBGZWhsZXIgYmVpICR7ZmlsZS5uYW1lfTogJHtlcnJvci5tZXNzYWdlfWAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBGb3J0c2Nocml0dCBha3R1YWxpc2llcmVuXG4gICAgICAgICAgc2VuZERhdGEoeyBcbiAgICAgICAgICAgIHR5cGU6ICdwcm9ncmVzcycsIFxuICAgICAgICAgICAgcHJvY2Vzc2VkOiBwcm9jZXNzZWRDb3VudCwgXG4gICAgICAgICAgICBjb21wbGV0ZWQ6IGNvbXBsZXRlZENvdW50LFxuICAgICAgICAgICAgZmFpbGVkOiBmYWlsZWRDb3VudFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBsb2FkLUJhdGNoIFN0YXR1cyBha3R1YWxpc2llcmVuXG4gICAgICAgIGF3YWl0IHByaXNtYS51cGxvYWRCYXRjaC51cGRhdGUoe1xuICAgICAgICAgIHdoZXJlOiB7IGJhdGNoSWQgfSxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBwcm9jZXNzZWRGaWxlczogcHJvY2Vzc2VkQ291bnQsXG4gICAgICAgICAgICBjb21wbGV0ZWRGaWxlczogY29tcGxldGVkQ291bnQsXG4gICAgICAgICAgICBmYWlsZWRGaWxlczogZmFpbGVkQ291bnQsXG4gICAgICAgICAgICBzdGF0dXM6IGZhaWxlZENvdW50ID09PSBmaWxlcy5sZW5ndGggPyAnZmFpbGVkJyA6ICdjb21wbGV0ZWQnXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzZW5kRGF0YSh7IHR5cGU6ICdjb21wbGV0ZWQnIH0pO1xuICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2Rlci5lbmNvZGUoJ2RhdGE6IFtET05FXVxcblxcbicpKTtcbiAgICAgICAgY29udHJvbGxlci5jbG9zZSgpO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiBuZXcgUmVzcG9uc2Uoc3RyZWFtLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9ldmVudC1zdHJlYW0nLFxuICAgICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsXG4gICAgICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLFxuICAgICAgfSxcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignVW5lcndhcnRldGVyIEZlaGxlcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ1VuZXJ3YXJ0ZXRlciBTZXJ2ZXItRmVobGVyJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBhbmFseXplSW1hZ2UoYmFzZTY0U3RyaW5nOiBzdHJpbmcsIGZpbGVOYW1lOiBzdHJpbmcsIHBsYWNlTmFtZTogc3RyaW5nIHwgbnVsbCk6IFByb21pc2U8eyBsb2NhdGlvbjogc3RyaW5nOyBzY2VuZTogc3RyaW5nIH0gfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGxhY2VDb250ZXh0ID0gcGxhY2VOYW1lIFxuICAgICAgPyBgXFxuXFxuWnVzw6R0emxpY2hlIEtvbnRleHQtSW5mb3JtYXRpb246IERhcyBGb3RvIHd1cmRlIGF1Zmdlbm9tbWVuIGJlaS9pbiBcIiR7cGxhY2VOYW1lfVwiLiBXZW5uIGRpZXMgZWluIHNwZXppZmlzY2hlciBPcnQgaXN0ICh6LkIuIGVpbmUgUGFya2FubGFnZSwgZWluIFJlc3RhdXJhbnQsIGVpbiBEZW5rbWFsKSwgdmVyd2VuZGUgZGllc2VuIE5hbWVuIGFscyBPcnQtS2F0ZWdvcmllLiBBbnNvbnN0ZW4gdmVyd2VuZGUgZWluZSBhbGxnZW1laW5lIEthdGVnb3JpZS5gXG4gICAgICA6ICcnO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcHBzLmFiYWN1cy5haS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Byb2Nlc3MuZW52LkFCQUNVU0FJX0FQSV9LRVl9YFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6ICdncHQtNC4xLW1pbmknLFxuICAgICAgICBtZXNzYWdlczogW3tcbiAgICAgICAgICByb2xlOiBcInVzZXJcIiwgXG4gICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0eXBlOiBcInRleHRcIiwgXG4gICAgICAgICAgICAgIHRleHQ6IGBBbmFseXNpZXJlIGRpZXNlcyBCaWxkIHVuZCBiZXN0aW1tZTpcbjEuIERpZSBPcnQtS2F0ZWdvcmllICh6LkIuIFN0cmFuZCwgUmVzdGF1cmFudCwgQXV0bywgV2FsZCwgUGFyaywgQsO8cm8sIFp1aGF1c2UsIGV0Yy4pIC0gbWF4aW1hbCAyLTMgV8O2cnRlciBhdWYgRGV1dHNjaFxuMi4gRWluZSBTemVuZS1CZXNjaHJlaWJ1bmcgbWl0IGVpbmVtIEFkamVrdGl2L1dvcnQgYXVmIERldXRzY2ggKHouQi4gc29ubmlnLCBnZW3DvHRsaWNoLCBtb2Rlcm4sIGR1bmtlbCwgZXRjLikke3BsYWNlQ29udGV4dH1cblxuKipXSUNIVElHIEbDnFIgU0NISUxERVI6KipcbkZhbGxzIGltIEJpbGQgZWluIFNjaGlsZCwgUGxha2F0LCBIaW53ZWlzc2NoaWxkLCBTdHJhw59lbnNjaGlsZCwgV2Vnd2Vpc2VyLCBJbmZvcm1hdGlvbnN0YWZlbCBvZGVyIMOkaG5saWNoZXMgenUgc2VoZW4gaXN0OlxuLSBWZXJ3ZW5kZSBcIlNjaGlsZFwiIGFscyBPcnQtS2F0ZWdvcmllXG4tIExpZXMgZGVuIFRleHQgYXVmIGRlbSBTY2hpbGQgdW5kIHZlcndlbmRlIGlobiBhbHMgU3plbmUtQmVzY2hyZWlidW5nICh6LkIuIFwiUGFya2VuLXZlcmJvdGVuXCIsIFwiRWluZ2FuZy1BXCIsIFwiQmVybGluLUhhdXB0YmFobmhvZlwiLCBldGMuKVxuLSBGYWxscyBtZWhyZXJlIFRleHRlIGF1ZiBkZW0gU2NoaWxkIHNpbmQsIHZlcndlbmRlIGRlbiB3aWNodGlnc3Rlbi9ncsO2w590ZW4gVGV4dFxuLSBFbnRmZXJuZSBTYXR6emVpY2hlbiB1bmQgdmVyd2VuZGUgQmluZGVzdHJpY2hlIHN0YXR0IExlZXJ6ZWljaGVuXG5cbkFudHdvcnRlIG51ciBpbiBmb2xnZW5kZW0gSlNPTi1Gb3JtYXQ6XG57XG4gIFwibG9jYXRpb25cIjogXCJPcnQtS2F0ZWdvcmllXCIsXG4gIFwic2NlbmVcIjogXCJTemVuZS1CZXNjaHJlaWJ1bmdcIlxufVxuXG5WZXJ3ZW5kZSBudXIgZGV1dHNjaGUgQmVncmlmZmUgdW5kIGhhbHRlIHNpZSBrdXJ6IHVuZCBwcsOkZ25hbnQuIEbDvHIgZGllIE9ydC1LYXRlZ29yaWU6IFZlcndlbmRlIEJpbmRlc3RyaWNoZSBzdGF0dCBMZWVyemVpY2hlbiAoei5CLiBcIkNlbnRyYWwtUGFya1wiIHN0YXR0IFwiQ2VudHJhbCBQYXJrXCIpLmBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR5cGU6IFwiaW1hZ2VfdXJsXCIsIFxuICAgICAgICAgICAgICBpbWFnZV91cmw6IHtcbiAgICAgICAgICAgICAgICB1cmw6IGBkYXRhOmltYWdlL2pwZWc7YmFzZTY0LCR7YmFzZTY0U3RyaW5nfWBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF1cbiAgICAgICAgfV0sXG4gICAgICAgIHJlc3BvbnNlX2Zvcm1hdDogeyB0eXBlOiBcImpzb25fb2JqZWN0XCIgfSxcbiAgICAgICAgbWF4X3Rva2VuczogMjAwLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgfSksXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFZpc2lvbiBBSSBBUEkgRmVobGVyOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgY29uc3QgY29udGVudCA9IHJlc3VsdC5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQ7XG4gICAgXG4gICAgaWYgKCFjb250ZW50KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tlaW5lIEFudHdvcnQgdm9uIFZpc2lvbiBBSSBlcmhhbHRlbicpO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UoY29udGVudCk7XG4gICAgXG4gICAgaWYgKCFwYXJzZWQubG9jYXRpb24gfHwgIXBhcnNlZC5zY2VuZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbnZvbGxzdMOkbmRpZ2UgVmlzaW9uIEFJIEFuYWx5c2UnKTtcbiAgICB9XG5cbiAgICAvLyBMZWVyemVpY2hlbiBkdXJjaCBCaW5kZXN0cmljaGUgZXJzZXR6ZW4gdW5kIFNvbmRlcnplaWNoZW4gZW50ZmVybmVuXG4gICAgY29uc3Qgc2FuaXRpemVGb3JGaWxlbmFtZSA9IChzdHI6IHN0cmluZykgPT4ge1xuICAgICAgcmV0dXJuIHN0clxuICAgICAgICAudHJpbSgpXG4gICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICctJylcbiAgICAgICAgLnJlcGxhY2UoL1teYS16QS1aMC05w6TDtsO8w4TDlsOcw59cXC1dL2csICcnKVxuICAgICAgICAucmVwbGFjZSgvLSsvZywgJy0nKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGxvY2F0aW9uOiBzYW5pdGl6ZUZvckZpbGVuYW1lKHBhcnNlZC5sb2NhdGlvbiksXG4gICAgICBzY2VuZTogc2FuaXRpemVGb3JGaWxlbmFtZShwYXJzZWQuc2NlbmUpXG4gICAgfTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcignVmlzaW9uIEFJIEFuYWx5c2UgRmVobGVyOicsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFZpc2lvbiBBSSBBbmFseXNlIGZlaGxnZXNjaGxhZ2VuOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0UGxhY2VOYW1lKGxhdGl0dWRlOiBudW1iZXIsIGxvbmdpdHVkZTogbnVtYmVyKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgLy8gT3BlblN0cmVldE1hcCBOb21pbmF0aW0gQVBJIGbDvHIgUmV2ZXJzZSBHZW9jb2RpbmcgKGtvc3RlbmxvcylcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgYGh0dHBzOi8vbm9taW5hdGltLm9wZW5zdHJlZXRtYXAub3JnL3JldmVyc2U/Zm9ybWF0PWpzb24mbGF0PSR7bGF0aXR1ZGV9Jmxvbj0ke2xvbmdpdHVkZX0mem9vbT0xOCZhZGRyZXNzZGV0YWlscz0xYCxcbiAgICAgIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdVc2VyLUFnZW50JzogJ0ZvdG9JZGVudGlmaWthdGlvblN5c3RlbS8xLjAnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc29sZS53YXJuKCdOb21pbmF0aW0gQVBJIEZlaGxlcjonLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBcbiAgICAvLyBQcmlvcmlzaWVyZSBzcGV6aWZpc2NoZSBPcnRlXG4gICAgY29uc3QgcGxhY2VOYW1lID0gXG4gICAgICBkYXRhLmFkZHJlc3M/LnRvdXJpc20gfHwgICAgICAgICAgIC8vIHouQi4gU2VoZW5zd8O8cmRpZ2tlaXRlbiwgRGVua23DpGxlclxuICAgICAgZGF0YS5hZGRyZXNzPy5sZWlzdXJlIHx8ICAgICAgICAgICAvLyB6LkIuIFBhcmtzLCBTcGllbHBsw6R0emVcbiAgICAgIGRhdGEuYWRkcmVzcz8uYW1lbml0eSB8fCAgICAgICAgICAgLy8gei5CLiBSZXN0YXVyYW50cywgQ2Fmw6lzXG4gICAgICBkYXRhLmFkZHJlc3M/LmJ1aWxkaW5nIHx8ICAgICAgICAgIC8vIHouQi4gc3BlemlmaXNjaGUgR2Viw6R1ZGVcbiAgICAgIGRhdGEuYWRkcmVzcz8ubmVpZ2hib3VyaG9vZCB8fCAgICAgLy8gei5CLiBTdGFkdHZpZXJ0ZWxcbiAgICAgIGRhdGEuYWRkcmVzcz8uc3VidXJiIHx8ICAgICAgICAgICAgLy8gei5CLiBTdGFkdHRlaWxlXG4gICAgICBkYXRhLmFkZHJlc3M/LnRvd24gfHwgICAgICAgICAgICAgIC8vIHouQi4ga2xlaW5lIFN0w6RkdGVcbiAgICAgIGRhdGEuYWRkcmVzcz8uY2l0eSB8fCAgICAgICAgICAgICAgLy8gei5CLiBTdMOkZHRlXG4gICAgICBkYXRhLmFkZHJlc3M/LnZpbGxhZ2U7ICAgICAgICAgICAgIC8vIHouQi4gRMO2cmZlclxuXG4gICAgcmV0dXJuIHBsYWNlTmFtZSB8fCBudWxsO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmVobGVyIGJlaW0gQWJydWZlbiBkZXMgT3J0c25hbWVuczonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dFNlcXVlbmNlTnVtYmVyKGxvY2F0aW9uOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNvdW50ZXIgPSBhd2FpdCBwcmlzbWEuY2F0ZWdvcnlDb3VudGVyLnVwc2VydCh7XG4gICAgICB3aGVyZTogeyBjYXRlZ29yeU5hbWU6IGxvY2F0aW9uIH0sXG4gICAgICB1cGRhdGU6IHtcbiAgICAgICAgY3VycmVudENvdW50ZXI6IHsgaW5jcmVtZW50OiAxIH1cbiAgICAgIH0sXG4gICAgICBjcmVhdGU6IHtcbiAgICAgICAgY2F0ZWdvcnlOYW1lOiBsb2NhdGlvbixcbiAgICAgICAgY3VycmVudENvdW50ZXI6IDFcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBjb3VudGVyLmN1cnJlbnRDb3VudGVyO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZlaGxlciBiZWltIEdlbmVyaWVyZW4gZGVyIFNlcXVlbnpudW1tZXI6JywgZXJyb3IpO1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwKSArIDE7IC8vIEZhbGxiYWNrXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJkeW5hbWljIiwiTmV4dFJlc3BvbnNlIiwiUHJpc21hQ2xpZW50IiwidXBsb2FkRmlsZSIsImV4dHJhY3RFeGlmRGF0YSIsImV4dHJhY3RHZW9EYXRhIiwiZ2V0Q2FtZXJhTW9kZWwiLCJnZXREYXRlVGltZVRha2VuIiwicHJpc21hIiwiUE9TVCIsInJlcXVlc3QiLCJmb3JtRGF0YSIsImJhdGNoSWQiLCJnZXQiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJmaWxlcyIsImtleSIsInZhbHVlIiwiZW50cmllcyIsInN0YXJ0c1dpdGgiLCJGaWxlIiwiaW5kZXgiLCJwYXJzZUludCIsInJlcGxhY2UiLCJwdXNoIiwiZmlsZSIsImxlbmd0aCIsInVwbG9hZEJhdGNoIiwiY3JlYXRlIiwiZGF0YSIsInRvdGFsRmlsZXMiLCJzdHJlYW0iLCJSZWFkYWJsZVN0cmVhbSIsInN0YXJ0IiwiY29udHJvbGxlciIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsInNlbmREYXRhIiwiZW5xdWV1ZSIsImVuY29kZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm9jZXNzZWRDb3VudCIsImNvbXBsZXRlZENvdW50IiwiZmFpbGVkQ291bnQiLCJ0eXBlIiwicHJvY2Vzc2VkIiwiY29tcGxldGVkIiwiZmFpbGVkIiwiY3VycmVudCIsIm5hbWUiLCJleGlmRGF0YSIsImdlb0RhdGEiLCJjYW1lcmFNb2RlbCIsImRhdGVUaW1lVGFrZW4iLCJidWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiYXJyYXlCdWZmZXIiLCJjbG91ZFN0b3JhZ2VQYXRoIiwicGxhY2VOYW1lIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJnZXRQbGFjZU5hbWUiLCJiYXNlNjRTdHJpbmciLCJ0b1N0cmluZyIsImFuYWx5c2lzUmVzdWx0IiwiYW5hbHl6ZUltYWdlIiwibG9jYXRpb24iLCJzY2VuZSIsIkVycm9yIiwic2VxdWVuY2VOdW1iZXIiLCJnZXROZXh0U2VxdWVuY2VOdW1iZXIiLCJmaWxlRXh0ZW5zaW9uIiwic3BsaXQiLCJwb3AiLCJ0b0xvd2VyQ2FzZSIsIm5ld05hbWUiLCJwYWRTdGFydCIsInBob3RvIiwib3JpZ2luYWxOYW1lIiwiYWx0aXR1ZGUiLCJjb25zb2xlIiwicHJvY2Vzc2luZ0Vycm9yIiwibWVzc2FnZSIsImRiRXJyb3IiLCJ1cGRhdGUiLCJ3aGVyZSIsInByb2Nlc3NlZEZpbGVzIiwiY29tcGxldGVkRmlsZXMiLCJmYWlsZWRGaWxlcyIsImNsb3NlIiwiUmVzcG9uc2UiLCJoZWFkZXJzIiwiZmlsZU5hbWUiLCJwbGFjZUNvbnRleHQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwicHJvY2VzcyIsImVudiIsIkFCQUNVU0FJX0FQSV9LRVkiLCJib2R5IiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwidGV4dCIsImltYWdlX3VybCIsInVybCIsInJlc3BvbnNlX2Zvcm1hdCIsIm1heF90b2tlbnMiLCJ0ZW1wZXJhdHVyZSIsIm9rIiwicmVzdWx0IiwiY2hvaWNlcyIsInBhcnNlZCIsInBhcnNlIiwic2FuaXRpemVGb3JGaWxlbmFtZSIsInN0ciIsInRyaW0iLCJ3YXJuIiwiYWRkcmVzcyIsInRvdXJpc20iLCJsZWlzdXJlIiwiYW1lbml0eSIsImJ1aWxkaW5nIiwibmVpZ2hib3VyaG9vZCIsInN1YnVyYiIsInRvd24iLCJjaXR5IiwidmlsbGFnZSIsImNvdW50ZXIiLCJjYXRlZ29yeUNvdW50ZXIiLCJ1cHNlcnQiLCJjYXRlZ29yeU5hbWUiLCJjdXJyZW50Q291bnRlciIsImluY3JlbWVudCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/process-photos/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/aws-config.ts":
/*!***************************!*\
  !*** ./lib/aws-config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createS3Client: () => (/* binding */ createS3Client),\n/* harmony export */   getBucketConfig: () => (/* binding */ getBucketConfig)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction getBucketConfig() {\n    return {\n        bucketName: process.env.AWS_BUCKET_NAME,\n        folderPrefix: process.env.AWS_FOLDER_PREFIX || \"\"\n    };\n}\nfunction createS3Client() {\n    return new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.S3Client({});\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXdzLWNvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQzhDO0FBRXZDLFNBQVNDO0lBQ2QsT0FBTztRQUNMQyxZQUFZQyxRQUFRQyxHQUFHLENBQUNDLGVBQWU7UUFDdkNDLGNBQWNILFFBQVFDLEdBQUcsQ0FBQ0csaUJBQWlCLElBQUk7SUFDakQ7QUFDRjtBQUVPLFNBQVNDO0lBQ2QsT0FBTyxJQUFJUix3REFBUUEsQ0FBQyxDQUFDO0FBQ3ZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBwLy4vbGliL2F3cy1jb25maWcudHM/YmMxZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IFMzQ2xpZW50IH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1zM1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QnVja2V0Q29uZmlnKCkge1xuICByZXR1cm4ge1xuICAgIGJ1Y2tldE5hbWU6IHByb2Nlc3MuZW52LkFXU19CVUNLRVRfTkFNRSEsXG4gICAgZm9sZGVyUHJlZml4OiBwcm9jZXNzLmVudi5BV1NfRk9MREVSX1BSRUZJWCB8fCBcIlwiXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTM0NsaWVudCgpIHtcbiAgcmV0dXJuIG5ldyBTM0NsaWVudCh7fSk7XG59XG4iXSwibmFtZXMiOlsiUzNDbGllbnQiLCJnZXRCdWNrZXRDb25maWciLCJidWNrZXROYW1lIiwicHJvY2VzcyIsImVudiIsIkFXU19CVUNLRVRfTkFNRSIsImZvbGRlclByZWZpeCIsIkFXU19GT0xERVJfUFJFRklYIiwiY3JlYXRlUzNDbGllbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/aws-config.ts\n");

/***/ }),

/***/ "(rsc)/./lib/exif-utils.ts":
/*!***************************!*\
  !*** ./lib/exif-utils.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractExifData: () => (/* binding */ extractExifData),\n/* harmony export */   extractGeoData: () => (/* binding */ extractGeoData),\n/* harmony export */   getCameraModel: () => (/* binding */ getCameraModel),\n/* harmony export */   getDateTimeTaken: () => (/* binding */ getDateTimeTaken)\n/* harmony export */ });\n/* harmony import */ var exifreader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! exifreader */ \"(rsc)/./node_modules/exifreader/src/exif-reader.js\");\n\nasync function extractExifData(file) {\n    try {\n        const arrayBuffer = await file.arrayBuffer();\n        const tags = await exifreader__WEBPACK_IMPORTED_MODULE_0__[\"default\"].load(arrayBuffer, {\n            expanded: true\n        });\n        if (!tags || Object.keys(tags).length === 0) {\n            return null;\n        }\n        // Konvertiere ExifReader Tags zu unserem ExifData Format\n        const exifData = {};\n        // Basis-Informationen\n        if (tags.exif) {\n            if (tags.exif.Make?.description) exifData.Make = tags.exif.Make.description;\n            if (tags.exif.Model?.description) exifData.Model = tags.exif.Model.description;\n            if (tags.exif.DateTime?.description) exifData.DateTime = tags.exif.DateTime.description;\n            if (tags.exif.DateTimeOriginal?.description) exifData.DateTimeOriginal = tags.exif.DateTimeOriginal.description;\n        }\n        // GPS-Daten - ExifReader gibt bereits Dezimalwerte zurück\n        if (tags.gps) {\n            exifData.GPS = {};\n            if (typeof tags.gps.Latitude === \"number\") {\n                exifData.GPS.GPSLatitude = tags.gps.Latitude;\n                exifData.GPS.GPSLatitudeRef = tags.gps.Latitude >= 0 ? \"N\" : \"S\";\n            }\n            if (typeof tags.gps.Longitude === \"number\") {\n                exifData.GPS.GPSLongitude = tags.gps.Longitude;\n                exifData.GPS.GPSLongitudeRef = tags.gps.Longitude >= 0 ? \"E\" : \"W\";\n            }\n            if (typeof tags.gps.Altitude === \"number\") {\n                exifData.GPS.GPSAltitude = tags.gps.Altitude;\n            }\n        }\n        return exifData;\n    } catch (error) {\n        console.error(\"EXIF extraction error:\", error);\n        return null;\n    }\n}\nfunction extractGeoData(exifData) {\n    if (!exifData?.GPS) {\n        return {};\n    }\n    const gps = exifData.GPS;\n    // ExifReader gibt bereits korrekte Dezimalwerte mit Vorzeichen zurück\n    // Negative Werte für South (S) und West (W) sind bereits enthalten\n    return {\n        latitude: typeof gps.GPSLatitude === \"number\" ? gps.GPSLatitude : undefined,\n        longitude: typeof gps.GPSLongitude === \"number\" ? gps.GPSLongitude : undefined,\n        altitude: typeof gps.GPSAltitude === \"number\" ? gps.GPSAltitude : undefined\n    };\n}\nfunction getCameraModel(exifData) {\n    if (!exifData) return undefined;\n    const make = exifData.Make || \"\";\n    const model = exifData.Model || \"\";\n    if (make && model) {\n        return `${make} ${model}`.trim();\n    } else if (model) {\n        return model;\n    } else if (make) {\n        return make;\n    }\n    return undefined;\n}\nfunction getDateTimeTaken(exifData) {\n    if (!exifData) return undefined;\n    // Versuche zuerst DateTimeOriginal, dann DateTime\n    const dateTimeStr = exifData.DateTimeOriginal || exifData.DateTime;\n    if (!dateTimeStr) return undefined;\n    try {\n        // EXIF DateTime format: \"2024:01:15 10:30:45\"\n        const normalizedStr = dateTimeStr.replace(/^(\\d{4}):(\\d{2}):(\\d{2})/, \"$1-$2-$3\");\n        return new Date(normalizedStr);\n    } catch  {\n        return undefined;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDOUIsTUFBTXdCLFFBQVExQixTQUFTSSxLQUFLLElBQUk7SUFFaEMsSUFBSXFCLFFBQVFDLE9BQU87UUFDakIsT0FBTyxDQUFDLEVBQUVELEtBQUssQ0FBQyxFQUFFQyxNQUFNLENBQUMsQ0FBQ0MsSUFBSTtJQUNoQyxPQUFPLElBQUlELE9BQU87UUFDaEIsT0FBT0E7SUFDVCxPQUFPLElBQUlELE1BQU07UUFDZixPQUFPQTtJQUNUO0lBRUEsT0FBT0o7QUFDVDtBQUVPLFNBQVNPLGlCQUFpQjVCLFFBQXlCO0lBQ3hELElBQUksQ0FBQ0EsVUFBVSxPQUFPcUI7SUFFdEIsa0RBQWtEO0lBQ2xELE1BQU1RLGNBQWM3QixTQUFTTSxnQkFBZ0IsSUFBSU4sU0FBU0ssUUFBUTtJQUVsRSxJQUFJLENBQUN3QixhQUFhLE9BQU9SO0lBRXpCLElBQUk7UUFDRiw4Q0FBOEM7UUFDOUMsTUFBTVMsZ0JBQWdCRCxZQUFZRSxPQUFPLENBQUMsNEJBQTRCO1FBQ3RFLE9BQU8sSUFBSUMsS0FBS0Y7SUFDbEIsRUFBRSxPQUFNO1FBQ04sT0FBT1Q7SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXBwLy4vbGliL2V4aWYtdXRpbHMudHM/YWFkYSJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBFeGlmUmVhZGVyIGZyb20gJ2V4aWZyZWFkZXInO1xuaW1wb3J0IHsgRXhpZkRhdGEsIEdlb0RhdGEgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RFeGlmRGF0YShmaWxlOiBGaWxlKTogUHJvbWlzZTxFeGlmRGF0YSB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGZpbGUuYXJyYXlCdWZmZXIoKTtcbiAgICBjb25zdCB0YWdzID0gYXdhaXQgRXhpZlJlYWRlci5sb2FkKGFycmF5QnVmZmVyLCB7IGV4cGFuZGVkOiB0cnVlIH0pO1xuICAgIFxuICAgIGlmICghdGFncyB8fCBPYmplY3Qua2V5cyh0YWdzKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIEtvbnZlcnRpZXJlIEV4aWZSZWFkZXIgVGFncyB6dSB1bnNlcmVtIEV4aWZEYXRhIEZvcm1hdFxuICAgIGNvbnN0IGV4aWZEYXRhOiBhbnkgPSB7fTtcblxuICAgIC8vIEJhc2lzLUluZm9ybWF0aW9uZW5cbiAgICBpZiAodGFncy5leGlmKSB7XG4gICAgICBpZiAodGFncy5leGlmLk1ha2U/LmRlc2NyaXB0aW9uKSBleGlmRGF0YS5NYWtlID0gdGFncy5leGlmLk1ha2UuZGVzY3JpcHRpb247XG4gICAgICBpZiAodGFncy5leGlmLk1vZGVsPy5kZXNjcmlwdGlvbikgZXhpZkRhdGEuTW9kZWwgPSB0YWdzLmV4aWYuTW9kZWwuZGVzY3JpcHRpb247XG4gICAgICBpZiAodGFncy5leGlmLkRhdGVUaW1lPy5kZXNjcmlwdGlvbikgZXhpZkRhdGEuRGF0ZVRpbWUgPSB0YWdzLmV4aWYuRGF0ZVRpbWUuZGVzY3JpcHRpb247XG4gICAgICBpZiAodGFncy5leGlmLkRhdGVUaW1lT3JpZ2luYWw/LmRlc2NyaXB0aW9uKSBleGlmRGF0YS5EYXRlVGltZU9yaWdpbmFsID0gdGFncy5leGlmLkRhdGVUaW1lT3JpZ2luYWwuZGVzY3JpcHRpb247XG4gICAgfVxuXG4gICAgLy8gR1BTLURhdGVuIC0gRXhpZlJlYWRlciBnaWJ0IGJlcmVpdHMgRGV6aW1hbHdlcnRlIHp1csO8Y2tcbiAgICBpZiAodGFncy5ncHMpIHtcbiAgICAgIGV4aWZEYXRhLkdQUyA9IHt9O1xuICAgICAgXG4gICAgICBpZiAodHlwZW9mIHRhZ3MuZ3BzLkxhdGl0dWRlID09PSAnbnVtYmVyJykge1xuICAgICAgICBleGlmRGF0YS5HUFMuR1BTTGF0aXR1ZGUgPSB0YWdzLmdwcy5MYXRpdHVkZTtcbiAgICAgICAgZXhpZkRhdGEuR1BTLkdQU0xhdGl0dWRlUmVmID0gdGFncy5ncHMuTGF0aXR1ZGUgPj0gMCA/ICdOJyA6ICdTJztcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdGFncy5ncHMuTG9uZ2l0dWRlID09PSAnbnVtYmVyJykge1xuICAgICAgICBleGlmRGF0YS5HUFMuR1BTTG9uZ2l0dWRlID0gdGFncy5ncHMuTG9uZ2l0dWRlO1xuICAgICAgICBleGlmRGF0YS5HUFMuR1BTTG9uZ2l0dWRlUmVmID0gdGFncy5ncHMuTG9uZ2l0dWRlID49IDAgPyAnRScgOiAnVyc7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHRhZ3MuZ3BzLkFsdGl0dWRlID09PSAnbnVtYmVyJykge1xuICAgICAgICBleGlmRGF0YS5HUFMuR1BTQWx0aXR1ZGUgPSB0YWdzLmdwcy5BbHRpdHVkZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZXhpZkRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRVhJRiBleHRyYWN0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdEdlb0RhdGEoZXhpZkRhdGE6IEV4aWZEYXRhIHwgbnVsbCk6IEdlb0RhdGEge1xuICBpZiAoIWV4aWZEYXRhPy5HUFMpIHtcbiAgICByZXR1cm4ge307XG4gIH1cblxuICBjb25zdCBncHMgPSBleGlmRGF0YS5HUFM7XG4gIFxuICAvLyBFeGlmUmVhZGVyIGdpYnQgYmVyZWl0cyBrb3JyZWt0ZSBEZXppbWFsd2VydGUgbWl0IFZvcnplaWNoZW4genVyw7xja1xuICAvLyBOZWdhdGl2ZSBXZXJ0ZSBmw7xyIFNvdXRoIChTKSB1bmQgV2VzdCAoVykgc2luZCBiZXJlaXRzIGVudGhhbHRlblxuICByZXR1cm4ge1xuICAgIGxhdGl0dWRlOiB0eXBlb2YgZ3BzLkdQU0xhdGl0dWRlID09PSAnbnVtYmVyJyA/IGdwcy5HUFNMYXRpdHVkZSA6IHVuZGVmaW5lZCxcbiAgICBsb25naXR1ZGU6IHR5cGVvZiBncHMuR1BTTG9uZ2l0dWRlID09PSAnbnVtYmVyJyA/IGdwcy5HUFNMb25naXR1ZGUgOiB1bmRlZmluZWQsXG4gICAgYWx0aXR1ZGU6IHR5cGVvZiBncHMuR1BTQWx0aXR1ZGUgPT09ICdudW1iZXInID8gZ3BzLkdQU0FsdGl0dWRlIDogdW5kZWZpbmVkXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDYW1lcmFNb2RlbChleGlmRGF0YTogRXhpZkRhdGEgfCBudWxsKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgaWYgKCFleGlmRGF0YSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgXG4gIGNvbnN0IG1ha2UgPSBleGlmRGF0YS5NYWtlIHx8ICcnO1xuICBjb25zdCBtb2RlbCA9IGV4aWZEYXRhLk1vZGVsIHx8ICcnO1xuICBcbiAgaWYgKG1ha2UgJiYgbW9kZWwpIHtcbiAgICByZXR1cm4gYCR7bWFrZX0gJHttb2RlbH1gLnRyaW0oKTtcbiAgfSBlbHNlIGlmIChtb2RlbCkge1xuICAgIHJldHVybiBtb2RlbDtcbiAgfSBlbHNlIGlmIChtYWtlKSB7XG4gICAgcmV0dXJuIG1ha2U7XG4gIH1cbiAgXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRlVGltZVRha2VuKGV4aWZEYXRhOiBFeGlmRGF0YSB8IG51bGwpOiBEYXRlIHwgdW5kZWZpbmVkIHtcbiAgaWYgKCFleGlmRGF0YSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgXG4gIC8vIFZlcnN1Y2hlIHp1ZXJzdCBEYXRlVGltZU9yaWdpbmFsLCBkYW5uIERhdGVUaW1lXG4gIGNvbnN0IGRhdGVUaW1lU3RyID0gZXhpZkRhdGEuRGF0ZVRpbWVPcmlnaW5hbCB8fCBleGlmRGF0YS5EYXRlVGltZTtcbiAgXG4gIGlmICghZGF0ZVRpbWVTdHIpIHJldHVybiB1bmRlZmluZWQ7XG4gIFxuICB0cnkge1xuICAgIC8vIEVYSUYgRGF0ZVRpbWUgZm9ybWF0OiBcIjIwMjQ6MDE6MTUgMTA6MzA6NDVcIlxuICAgIGNvbnN0IG5vcm1hbGl6ZWRTdHIgPSBkYXRlVGltZVN0ci5yZXBsYWNlKC9eKFxcZHs0fSk6KFxcZHsyfSk6KFxcZHsyfSkvLCAnJDEtJDItJDMnKTtcbiAgICByZXR1cm4gbmV3IERhdGUobm9ybWFsaXplZFN0cik7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJFeGlmUmVhZGVyIiwiZXh0cmFjdEV4aWZEYXRhIiwiZmlsZSIsImFycmF5QnVmZmVyIiwidGFncyIsImxvYWQiLCJleHBhbmRlZCIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJleGlmRGF0YSIsImV4aWYiLCJNYWtlIiwiZGVzY3JpcHRpb24iLCJNb2RlbCIsIkRhdGVUaW1lIiwiRGF0ZVRpbWVPcmlnaW5hbCIsImdwcyIsIkdQUyIsIkxhdGl0dWRlIiwiR1BTTGF0aXR1ZGUiLCJHUFNMYXRpdHVkZVJlZiIsIkxvbmdpdHVkZSIsIkdQU0xvbmdpdHVkZSIsIkdQU0xvbmdpdHVkZVJlZiIsIkFsdGl0dWRlIiwiR1BTQWx0aXR1ZGUiLCJlcnJvciIsImNvbnNvbGUiLCJleHRyYWN0R2VvRGF0YSIsImxhdGl0dWRlIiwidW5kZWZpbmVkIiwibG9uZ2l0dWRlIiwiYWx0aXR1ZGUiLCJnZXRDYW1lcmFNb2RlbCIsIm1ha2UiLCJtb2RlbCIsInRyaW0iLCJnZXREYXRlVGltZVRha2VuIiwiZGF0ZVRpbWVTdHIiLCJub3JtYWxpemVkU3RyIiwicmVwbGFjZSIsIkRhdGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/exif-utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/s3.ts":
/*!*******************!*\
  !*** ./lib/s3.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteFile: () => (/* binding */ deleteFile),\n/* harmony export */   downloadFile: () => (/* binding */ downloadFile),\n/* harmony export */   uploadFile: () => (/* binding */ uploadFile)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _aws_sdk_s3_request_presigner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aws-sdk/s3-request-presigner */ \"(rsc)/./node_modules/@aws-sdk/s3-request-presigner/dist-es/getSignedUrl.js\");\n/* harmony import */ var _aws_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./aws-config */ \"(rsc)/./lib/aws-config.ts\");\n\n\n\nconst s3Client = (0,_aws_config__WEBPACK_IMPORTED_MODULE_1__.createS3Client)();\nconst { bucketName, folderPrefix } = (0,_aws_config__WEBPACK_IMPORTED_MODULE_1__.getBucketConfig)();\nasync function uploadFile(buffer, fileName) {\n    const key = `${folderPrefix}uploads/${Date.now()}-${fileName}`;\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: bucketName,\n        Key: key,\n        Body: buffer,\n        ContentType: \"image/*\"\n    });\n    await s3Client.send(command);\n    return key;\n}\nasync function downloadFile(key) {\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n        Bucket: bucketName,\n        Key: key\n    });\n    const signedUrl = await (0,_aws_sdk_s3_request_presigner__WEBPACK_IMPORTED_MODULE_2__.getSignedUrl)(s3Client, command, {\n        expiresIn: 3600\n    });\n    return signedUrl;\n}\nasync function deleteFile(key) {\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.DeleteObjectCommand({\n        Bucket: bucketName,\n        Key: key\n    });\n    await s3Client.send(command);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvczMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUN1RztBQUMxQztBQUNFO0FBRS9ELE1BQU1NLFdBQVdELDJEQUFjQTtBQUMvQixNQUFNLEVBQUVFLFVBQVUsRUFBRUMsWUFBWSxFQUFFLEdBQUdKLDREQUFlQTtBQUU3QyxlQUFlSyxXQUFXQyxNQUFjLEVBQUVDLFFBQWdCO0lBQy9ELE1BQU1DLE1BQU0sQ0FBQyxFQUFFSixhQUFhLFFBQVEsRUFBRUssS0FBS0MsR0FBRyxHQUFHLENBQUMsRUFBRUgsU0FBUyxDQUFDO0lBRTlELE1BQU1JLFVBQVUsSUFBSWYsZ0VBQWdCQSxDQUFDO1FBQ25DZ0IsUUFBUVQ7UUFDUlUsS0FBS0w7UUFDTE0sTUFBTVI7UUFDTlMsYUFBYTtJQUNmO0lBRUEsTUFBTWIsU0FBU2MsSUFBSSxDQUFDTDtJQUNwQixPQUFPSDtBQUNUO0FBRU8sZUFBZVMsYUFBYVQsR0FBVztJQUM1QyxNQUFNRyxVQUFVLElBQUlkLGdFQUFnQkEsQ0FBQztRQUNuQ2UsUUFBUVQ7UUFDUlUsS0FBS0w7SUFDUDtJQUVBLE1BQU1VLFlBQVksTUFBTW5CLDJFQUFZQSxDQUFDRyxVQUFVUyxTQUFTO1FBQUVRLFdBQVc7SUFBSztJQUMxRSxPQUFPRDtBQUNUO0FBRU8sZUFBZUUsV0FBV1osR0FBVztJQUMxQyxNQUFNRyxVQUFVLElBQUliLG1FQUFtQkEsQ0FBQztRQUN0Q2MsUUFBUVQ7UUFDUlUsS0FBS0w7SUFDUDtJQUVBLE1BQU1OLFNBQVNjLElBQUksQ0FBQ0w7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcHAvLi9saWIvczMudHM/Y2U2YSJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IFMzQ2xpZW50LCBQdXRPYmplY3RDb21tYW5kLCBHZXRPYmplY3RDb21tYW5kLCBEZWxldGVPYmplY3RDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1zM1wiO1xuaW1wb3J0IHsgZ2V0U2lnbmVkVXJsIH0gZnJvbSBcIkBhd3Mtc2RrL3MzLXJlcXVlc3QtcHJlc2lnbmVyXCI7XG5pbXBvcnQgeyBnZXRCdWNrZXRDb25maWcsIGNyZWF0ZVMzQ2xpZW50IH0gZnJvbSBcIi4vYXdzLWNvbmZpZ1wiO1xuXG5jb25zdCBzM0NsaWVudCA9IGNyZWF0ZVMzQ2xpZW50KCk7XG5jb25zdCB7IGJ1Y2tldE5hbWUsIGZvbGRlclByZWZpeCB9ID0gZ2V0QnVja2V0Q29uZmlnKCk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGxvYWRGaWxlKGJ1ZmZlcjogQnVmZmVyLCBmaWxlTmFtZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3Qga2V5ID0gYCR7Zm9sZGVyUHJlZml4fXVwbG9hZHMvJHtEYXRlLm5vdygpfS0ke2ZpbGVOYW1lfWA7XG4gIFxuICBjb25zdCBjb21tYW5kID0gbmV3IFB1dE9iamVjdENvbW1hbmQoe1xuICAgIEJ1Y2tldDogYnVja2V0TmFtZSxcbiAgICBLZXk6IGtleSxcbiAgICBCb2R5OiBidWZmZXIsXG4gICAgQ29udGVudFR5cGU6IFwiaW1hZ2UvKlwiXG4gIH0pO1xuXG4gIGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZCk7XG4gIHJldHVybiBrZXk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb3dubG9hZEZpbGUoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBjb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xuICAgIEJ1Y2tldDogYnVja2V0TmFtZSxcbiAgICBLZXk6IGtleVxuICB9KTtcblxuICBjb25zdCBzaWduZWRVcmwgPSBhd2FpdCBnZXRTaWduZWRVcmwoczNDbGllbnQsIGNvbW1hbmQsIHsgZXhwaXJlc0luOiAzNjAwIH0pO1xuICByZXR1cm4gc2lnbmVkVXJsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRmlsZShrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjb21tYW5kID0gbmV3IERlbGV0ZU9iamVjdENvbW1hbmQoe1xuICAgIEJ1Y2tldDogYnVja2V0TmFtZSxcbiAgICBLZXk6IGtleVxuICB9KTtcblxuICBhd2FpdCBzM0NsaWVudC5zZW5kKGNvbW1hbmQpO1xufVxuIl0sIm5hbWVzIjpbIlB1dE9iamVjdENvbW1hbmQiLCJHZXRPYmplY3RDb21tYW5kIiwiRGVsZXRlT2JqZWN0Q29tbWFuZCIsImdldFNpZ25lZFVybCIsImdldEJ1Y2tldENvbmZpZyIsImNyZWF0ZVMzQ2xpZW50IiwiczNDbGllbnQiLCJidWNrZXROYW1lIiwiZm9sZGVyUHJlZml4IiwidXBsb2FkRmlsZSIsImJ1ZmZlciIsImZpbGVOYW1lIiwia2V5IiwiRGF0ZSIsIm5vdyIsImNvbW1hbmQiLCJCdWNrZXQiLCJLZXkiLCJCb2R5IiwiQ29udGVudFR5cGUiLCJzZW5kIiwiZG93bmxvYWRGaWxlIiwic2lnbmVkVXJsIiwiZXhwaXJlc0luIiwiZGVsZXRlRmlsZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/s3.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/exifreader","vendor-chunks/@smithy","vendor-chunks/@aws-sdk"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess-photos%2Froute&page=%2Fapi%2Fprocess-photos%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess-photos%2Froute.ts&appDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fdyai%2FDokumente%2FDYAI_home%2FWeb%2FSimavi%2FSimavi-semantic_image_vision%2Ffoto_identifikation_system%2Fnextjs_space&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();